<script>
const k = new URLSearchParams(location.search).get("k");
const [F,S,I] = atob(k).split("|").map(x=>atob(x));
const API = "https://script.google.com/macros/s/AKfycbwpNhH1SAzbf-5U-cmd1KkQDLiaUx5bWf_QoLixIj2s3OolveS3womrs8xgOiP6StQxfw/exec";

const startBtn = document.getElementById("start");
const timerBox = document.getElementById("timer");
const actBox   = document.getElementById("act");
const vc = document.getElementById("vc");
const dc = document.getElementById("dc");

fetch(API+"?id="+I+"&act=visit")
.then(r=>r.json())
.then(d=>{ vc.innerText=d.visit; dc.innerText=d.download; });

function start(){
 let t=5;
 startBtn.style.display="none";
 timerBox.style.display="block";
 timerBox.innerText="Tunggu "+t+" detik";
 const x=setInterval(()=>{
  t--; timerBox.innerText="Tunggu "+t+" detik";
  if(t<=0){
    clearInterval(x);
    timerBox.style.display="none";
    actBox.style.display="block";
  }
 },1000);
}

function go(){
 fetch(API+"?id="+I+"&act=download");
 window.open(S,"_blank");
 setTimeout(()=>location.href=F,1200);
}
</script>
